
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/stylesheet/style.min.css">
  <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css">
  <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/stylesheet/ribbons.css">
  <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/stylesheet/custom.css">

    <link href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="PyBites Atom">

    <link href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites RSS">

    <link rel="shortcut icon" href="https://pybit.es/favicon.ico" type="image/x-icon">
    <link rel="icon" href="https://pybit.es/favicon.ico" type="image/x-icon">

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content="Bob" />
<meta name="description" content="Running your site or business good chance you A. use promo material like banners and B. you make them manually with Photoshop, Gimp or what not. And yes for anything beyond the basics you probably need those programs. But what if you like to keep it simple and want to semi-automate things? Just an image and text on canvas? Enter Pillow - The friendly PIL fork, which makes this pretty easy. Come explore some of its capabilities with me in this article." />
<meta name="keywords" content="Pillow, images, utilities, pybites, curl, refactoring, challenges, PyBites Banner Generator">
<meta property="og:site_name" content="PyBites"/>
<meta property="og:title" content="Using Pillow to Create Nice Banners For Your Site"/>
<meta property="og:description" content="Running your site or business good chance you A. use promo material like banners and B. you make them manually with Photoshop, Gimp or what not. And yes for anything beyond the basics you probably need those programs. But what if you like to keep it simple and want to semi-automate things? Just an image and text on canvas? Enter Pillow - The friendly PIL fork, which makes this pretty easy. Come explore some of its capabilities with me in this article."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://pybit.es/pillow-banner-image.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-08-11 14:00:00+02:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://pybit.es/author/bob.html">
<meta property="article:section" content="Modules"/>
<meta property="article:tag" content="Pillow"/>
<meta property="article:tag" content="images"/>
<meta property="article:tag" content="utilities"/>
<meta property="article:tag" content="pybites"/>
<meta property="article:tag" content="curl"/>
<meta property="article:tag" content="refactoring"/>
<meta property="article:tag" content="challenges"/>
<meta property="article:tag" content="PyBites Banner Generator"/>
<meta property="og:image" content="https://pybit.es/images/featured/pb-article.png">

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@pybites" />
<meta name="twitter:title" content="Using Pillow to Create Nice Banners For Your Site" />
<meta name="twitter:description" content="Running your site or business good chance you A. use promo material like banners and B. you make them manually with Photoshop, Gimp or what not. And yes for anything beyond the basics you probably need those programs. But what if you like to keep it simple and want to semi-automate things? Just an image and text on canvas? Enter Pillow - The friendly PIL fork, which makes this pretty easy. Come explore some of its capabilities with me in this article." />
<meta name="twitter:image" content="https://pybit.es/images/featured/pb-article.png">

  <title>PyBites &ndash; Using Pillow to Create Nice Banners For Your Site</title>


</head>
<body>

  <!-- change ribbon color based on topic -->
  <div class="ribbon right
      blue
  ">
    <a href="https://codechalleng.es" target="_blank">Click here to code!</a>
  </div>

  <!-- change aside color based on topic -->
    <aside class='blue'>
  
    <div>
      <a href="https://pybit.es">
          <img src="https://pybit.es/theme/img/article.png" alt="PyBites" title="PyBites">
      </a>
      <h1><a href="https://pybit.es">PyBites</a></h1>

<p>Python Code Challenges, Articles and News - One Bite a Day</p>
      <nav>
        <ul class="list">
          <li><a href="https://pybit.es/pages/about.html">About</a></li>
          <li><a href="https://pybit.es/pages/articles.html">Articles</a></li>
          <li><a href="https://pybit.es/pages/challenges.html">Challenges</a></li>
          <li><a href="https://pybit.es/pages/courses.html">Courses</a></li>
          <li><a href="https://pybit.es/pages/news.html">News</a></li>
          <li><a href="https://pybit.es/pages/projects.html">Projects</a></li>
          <li><a href="https://pybit.es/pages/search.html">Search</a></li>

        </ul>
      </nav>


	      <a class="twitter-follow-button" href="https://twitter.com/pybites" data-show-screen-name="false" data-size="large" data-show-count="false">Follow @pybites</a>

		    <a class="github-button" href="https://github.com/pybites" data-size="large" aria-label="Follow @pybites on GitHub">Follow</a>

      <br>
      <script src="https://apis.google.com/js/platform.js"></script>
      <div class="g-ytsubscribe" data-channelid="UCBn-uKDGsRBfcB0lQeOB_gA" data-layout="default" data-count="default"></div>

	
    </div>


  </aside>
  <main>


<article class="single">
  <header>
    <h1 id="pillow-banner-image">Using Pillow to Create Nice Banners For Your Site</h1>
    <p>
          Posted by <a href="https://pybit.es/author/bob.html">Bob</a> on Fri 11 August 2017 in <a href="https://pybit.es/category/modules.html">Modules</a>


        &#8226; 4 min read
    </p>
  </header>


  <div>
    <p>Running your site or business good chance you A. use promo material like banners and B. you make them manually with Photoshop, Gimp or what not. And yes for anything beyond the basics you probably need those programs. But what if you like to keep it simple and want to semi-automate things? Just an image and text on canvas? Enter <a href="https://python-pillow.org/">Pillow</a> - <em>The friendly PIL fork</em>, which makes this pretty easy. Come explore some of its capabilities with me in this article.</p>
<blockquote>
<p>The Python Imaging Library adds image processing capabilities to your Python interpreter. - <a href="https://pillow.readthedocs.io/en/4.2.x/handbook/overview.html">docs</a></p>
</blockquote>
<p>In this article we will use Pillow to create a simple promo banner for PyBites Code Challenges, starting with this week - how applicable! - <a href="https://pybit.es/codechallenge31.html">#31 - Image Manipulation With Pillow</a>. </p>
<p>By the way if you like to practice this stuff yourself, you should really join this week's challenge :)</p>
<p>We will position 2 images on a canvas adding a title using a nice font. In part 2 I will wrap a Flask app around it so you can use it in the browser.</p>
<p>The complete code for this article is <a href="https://github.com/pybites/blog_code/tree/master/pillow">here</a>.</p>
<h2>Getting ready</h2>
<p>First let's create a virtual env and install Pillow</p>
<div class="highlight"><pre><span></span>$ python3 -m venv venv <span class="o">&amp;&amp;</span> <span class="nb">source</span> venv/bin/activate
<span class="o">(</span>venv<span class="o">)</span> $ pip install Pillow
..
<span class="o">(</span>venv<span class="o">)</span> $ pip freeze &gt; requirements.txt
<span class="o">(</span>venv<span class="o">)</span> $ mkdir banner <span class="o">&amp;&amp;</span> <span class="nb">cd</span> <span class="nv">$_</span>
<span class="o">(</span>venv<span class="o">)</span> $ touch __init__.py
</pre></div>


<p>Let's get the images we will use for our banner.</p>
<div class="highlight"><pre><span></span>(venv) $ mkdir assets &amp;&amp; cd _
(venv) $ curl https://pybit.es/theme/img/page{-challenges.png} -o &quot;pybites#1&quot;
(venv) $ curl https://pbs.twimg.com/profile_images/510760404411109380/wDGjWJxk.png -o pillow-logo.png
(venv) $ cd ..
</pre></div>


<p>The <code>#1</code> tells curl to use the string I wrapped in <code>{}</code> for output filename:</p>
<h2>Step 1. - create a canvas and put our challenges logo on it:</h2>
<p>Let's write some code.</p>
<p><em>Disclaimer</em>: we just write it in a procedural way to get something working. We will refactor it in step 4.</p>
<p>Create a <code>banner.py</code> and add the following code:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageFont</span>

<span class="n">ASSET_DIR</span> <span class="o">=</span> <span class="s1">&#39;assets&#39;</span>
<span class="n">PB_CHALLENGE_IMG</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ASSET_DIR</span><span class="p">,</span> <span class="s1">&#39;pybites-challenges.png&#39;</span><span class="p">)</span>
<span class="n">PILLOW_IMG</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ASSET_DIR</span><span class="p">,</span> <span class="s1">&#39;pillow-logo.png&#39;</span><span class="p">)</span>
<span class="n">DEFAULT_WIDTH</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">DEFAULT_HEIGHT</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">DEFAULT_CANVAS_SIZE</span> <span class="o">=</span> <span class="p">(</span><span class="n">DEFAULT_WIDTH</span><span class="p">,</span> <span class="n">DEFAULT_HEIGHT</span><span class="p">)</span>
<span class="n">DEFAULT_TOP_MARGIN</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">WHITE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="n">DEFAULT_CANVAS_SIZE</span><span class="p">,</span> <span class="n">WHITE</span><span class="p">)</span>

<span class="n">pb_logo</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">PB_CHALLENGE_IMG</span><span class="p">)</span>
<span class="n">pb_logo_offset</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DEFAULT_TOP_MARGIN</span><span class="p">)</span>
<span class="n">image</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">pb_logo</span><span class="p">,</span> <span class="n">pb_logo_offset</span><span class="p">)</span>
<span class="n">pb_logo_width</span><span class="p">,</span> <span class="n">pb_logo_height</span> <span class="o">=</span> <span class="n">pb_logo</span><span class="o">.</span><span class="n">size</span>

<span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;out.png&#39;</span><span class="p">)</span>
</pre></div>


<p>We do our imports and set up some constants. <code>os.path.join</code> is always best practice to join directories and filenames to make it compatible across different operating systems.</p>
<p>We create a new canvas with <code>Image.new</code> stating the dimensions and background color. We put (<code>image.paste</code>) the Pybites challenges logo at an offset of left=0, top=15. And we store the image's width use height in variables for later use.</p>
<p>We save the image to a file which confirms this worked:</p>
<p><img alt="pillow-step1.png" class="border" src="https://pybit.es/images/pillow-step1.png"></p>
<h2>Step 2. - add a second image</h2>
<p>The second image is the Pillow logo. But the original is 442 × 442. Let's resize it. One way is to calculate it, <a href="https://github.com/pybites/100DaysOfCode/blob/master/074/text_on_image.py">like I did last time</a>. Another way is using the <code>thumbnail</code> method as I found <a href="https://stackoverflow.com/questions/2232742/does-python-pil-resize-maintain-the-aspect-ratio">on this SO thread</a>.</p>
<p>The offset of this second image gets calculated so it should still work if one day I decide to change the canvas or Pybites logo image sizes.</p>
<div class="highlight"><pre><span></span>...

second_img = Image.open(PILLOW_IMG)
second_img.thumbnail(pb_logo.size, Image.ANTIALIAS)

offset_second_img = (DEFAULT_WIDTH - pb_logo_width, DEFAULT_TOP_MARGIN)
image.paste(second_img, offset_second_img)

...
</pre></div>


<p><code>Image.ANTIALIAS</code> is a a high-quality downsampling filter which is recommended unless speed is much more important than quality.</p>
<p>Offsets in Pillow are (left, top). For top I use the same 15px. For width I want to align the second image to the right. To accomplish this I substract the image width (same as first image after resizing) from the total canvas width: 600px - 120px = 480px. This results in:</p>
<p><img alt="pillow-step2.png" class="border" src="https://pybit.es/images/pillow-step2.png"></p>
<p>Again we will clean this up later. At this stage I want to get something working, then make it reusable.</p>
<h2>Step 3. - add some text</h2>
<p>Here we need <code>ImageDraw</code> and <code>ImageFont</code> we already imported.</p>
<p><code>ImageFont.truetype</code> lets you work with nice fonts so let's get a <a href="https://en.wikipedia.org/wiki/TrueType">TrueType</a> file. </p>
<p>I used <a href="https://www.fontsquirrel.com/">Font Squirrel</a> and downloaded <a href="https://www.fontsquirrel.com/fonts/list/find_fonts?q%5Bterm%5D=ubuntu&amp;q%5Bsearch_check%5D=Y">Ubuntu</a> and <a href="https://www.fontsquirrel.com/fonts/source-sans-pro?q%5Bterm%5D=source+sans+pro&amp;q%5Bsearch_check%5D=Y">Source Sans Pro</a> (latter we use on our blog). I included both in the <code>assets</code> folder.</p>
<p>Add this code:</p>
<div class="highlight"><pre><span></span>...
BLACK = (0, 0, 0)
TEXT_FONT_TYPE = os.path.join(ASSET_DIR, &#39;SourceSansPro-Regular.otf&#39;)
TEXT_SIZE = 24
TEXT_PADDING_HOR = 20
TEXT_PADDING_VERT = 40
IMG_TEXT = &#39;Code Challenge 31:\nImage Manipulation With Pillow&#39;

...

draw = ImageDraw.Draw(image)
font = ImageFont.truetype(TEXT_FONT_TYPE, TEXT_SIZE)
offset_text = (pb_logo_width + TEXT_PADDING_HOR, TEXT_PADDING_VERT)
draw.text(offset_text, IMG_TEXT, BLACK, font=font)
...
</pre></div>


<p>We insert the text 40px from the top and 140px left (120px PyBites logo = first image width + 20px right padding) resulting in:</p>
<p><img alt="pillow-step3.png" class="border" src="https://pybit.es/images/pillow-step3.png"></p>
<h2>Step 4. - make it reusable</h2>
<p>I did some refactorings to make it easier to maintain / extend. See <a href="https://github.com/pybites/blog_code/blob/master/pillow/banner/banner.py">on Github</a>. </p>
<p>Few things to note:</p>
<ol>
<li>
<p>I added a simple CLI interface (just <code>sys.argv</code>, use <code>argparse</code> or <code>click</code> if you need more inputs). You can now run it like: </p>
<div class="highlight"><pre><span></span>(venv) $ python banner.py
Usage: banner.py img1 img2 text
(venv) $ python banner.py assets/pybites-challenges.png assets/pillow-logo.png $&#39;Code Challenge 31:\nImage Manipulation With Pillow&#39;
</pre></div>


<p>Note the required bash <code>$''</code> syntax, otherwise the <code>\n</code> won't be interpreted as a newline.</p>
</li>
<li>
<p>I use a class which makes this cleaner / easier to extend.</p>
</li>
<li>
<p>I calculated the <code>DEFAULT_TOP_MARGIN</code> = 150px height, image1 = 120px = 30px / 2 = 15px for top margin.</p>
</li>
<li>
<p>I use <em>named tuples</em> which you should <a href="https://docs.python.org/3/library/collections.html">lookup</a> if you're not familiar with them yet. One interesting use case is the reduction in function parameters for <code>add_text</code>: using a named tuple object it reduces the interface from 5 to 1 argument (see also the <a href="https://www.refactoring.com/catalog/introduceParameterObject.html">Introduce Parameter Object refactoring</a>).</p>
</li>
<li>
<p>I added the <code>self.image_coords</code> list to keep track of images being added to calculate where the text should go (right edge of most left image).</p>
</li>
</ol>
<h2>What's next?</h2>
<p>Now it's time to let the user interact with it via a simple (Flask) web app.</p>
<p>I will be doing that as part of <a href="https://pybit.es/codechallenge31.html">this week's code challenge</a> and will follow up with a part 2 article. Stay tuned ...</p>
<p>Pillow makes image manipulation easy and fun again. I hope this inspires you to try it out for yourself ...</p>
<p>Update 20/08/2017: check out <a href="https://pybit.es/pillow-banner-flask.html">part 2</a> where I wrap this script into a Flask app. In <a href="https://pybit.es/selenium-requests-automation.html">part 3</a> I automate banner generation with Requests and Selenium.</p>
<hr>
<p>Keep Calm and Code in Python!</p>
<p>-- Bob</p>
  </div>

  <hr>
  <p><strong>See an error in this post? Please submit a pull request <a href='https://github.com/pybites/pybites.github.io-src' target='_blank'>on Github.</a></strong></p>

<!-- Begin MailChimp Signup Form -->
<hr class="softDivider">
<div id="mc_embed_signup">
<form action="//pybit.us14.list-manage.com/subscribe/post?u=822043293f280259d4b8d2a3e&amp;id=ac7e2eb9ef" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
    
<div class="mc-field-group">
  <p><a href='http://us14.campaign-archive1.com/home/?u=822043293f280259d4b8d2a3e&id=ac7e2eb9ef'>Join our community</a> and grab our <i>Become a Better Python Developer</i> cheat sheet. Learn Python. Receive bonus material. Challenge yourself!</p>
    <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
</div>
    <div id="mce-responses" class="clear">
        <div class="response" id="mce-error-response" style="display:none"></div>
        <div class="response" id="mce-success-response" style="display:none"></div>
    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_822043293f280259d4b8d2a3e_ac7e2eb9ef" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Join Us" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>
<!--End mc_embed_signup-->
  <div class="tag-cloud">
    <p>
      <a href="https://pybit.es/tag/pillow.html">Pillow</a>
      <a href="https://pybit.es/tag/images.html">images</a>
      <a href="https://pybit.es/tag/utilities.html">utilities</a>
      <a href="https://pybit.es/tag/pybites.html">pybites</a>
      <a href="https://pybit.es/tag/curl.html">curl</a>
      <a href="https://pybit.es/tag/refactoring.html">refactoring</a>
      <a href="https://pybit.es/tag/challenges.html">challenges</a>
      <a href="https://pybit.es/tag/pybites-banner-generator.html">PyBites Banner Generator</a>
    </p>
  </div>

  <div class="center social-share">
    <p>    Like this article? Share it with your friends!
</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
  </div>



<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'http-pybit-es';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
</article>

    <footer>
<p>&copy; pybites </p>
<p>    Powered by <a href="https://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89294245-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

	<script>window.twttr = (function(d, s, id) {
	var js, fjs = d.getElementsByTagName(s)[0],
		t = window.twttr || {};
	if (d.getElementById(id)) return t;
	js = d.createElement(s);
	js.id = id;
	js.src = "https://platform.twitter.com/widgets.js";
	fjs.parentNode.insertBefore(js, fjs);
	t._e = [];
	t.ready = function(f) {
		t._e.push(f);
	};
	return t;
	}(document, "script", "twitter-wjs"));</script>

  <script async defer src="https://buttons.github.io/buttons.js"></script>
	
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5859c6a67eb6254d" async="async"></script>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " PyBites ",
  "url" : "https://pybit.es",
  "image": "https://pybit.es/theme/img/profile.png",
  "description": "Python Code Challenges, Articles and News - One Bite a Day"
}
</script>
</body>
</html>